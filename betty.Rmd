---
title: "Projekt A MT5016"
author: "Betty Frankl"
date: "`r Sys.Date()`"
output: html_document
---

## Projekt A

```{r, include=FALSE}
library(car)
library(knitr)
library(tidyverse)

load("data_1.Rda")
load("data_2.Rda")
```

```{r, include=FALSE}
# Functions

basic_plots <- function(data, title) {
  par(mfrow = c(2,3))
  plot(data$arblös_män, data$sjmo)
  plot(data$arblös_tot, data$sjmo)
  plot(data$alko, data$sjmo)
  plot(data$urban, data$sjmo)
  plot(data$skilsmässo, data$sjmo)
  plot(data$religio, data$sjmo)
  
  mtext(title, side = 3, line = - 1, outer = TRUE)
}

plot_predicted_residuals <- function(multi_model, title) {
  plot(multi_model$fitted.values, multi_model$residuals,
       xlab = "predikterade värden",
       ylab = "residualer",
       main = title)
  abline(0,0)
} 

plot_multi_residuals <- function(data, multi_model, title) {
  par(mfrow = c(2,3))
  plot(residuals(multi_model) ~ data$arblös_män, 
       xlab = "arbetslöshetsindex män",
       ylab = "residuals",
       main = "Spread of residuals")
  abline(0,0) 
  plot(residuals(multi_model) ~ data$arblös_tot, 
       xlab = "arbetslöshetsindex total",
       ylab = "residuals",
       main = "Spread of residuals")
  abline(0,0) 
  plot(residuals(multi_model) ~ data$alko, 
       xlab = "alkoholindex",
       ylab = "residuals",
       main = "Spread of residuals")
  abline(0,0) 
  plot(residuals(multi_model) ~ data$urban, 
       xlab = "urbaniseringsindex",
       ylab = "residuals",
       main = "Spread of residuals")
  abline(0,0) 
  plot(residuals(multi_model) ~ data$skilsmässo, 
       xlab = "skilsmässoindex",
       ylab = "residuals",
       main = "Spread of residuals")
  abline(0,0) 
  plot(residuals(multi_model) ~ data$religio, 
       xlab = "religiositetsindex",
       ylab = "residuals",
       main = "Spread of residuals")
  abline(0,0)
  
  mtext(title, side = 3, line = - 1, outer = TRUE)
}

plot_qq <- function(multi_model, title) {
  qqnorm(residuals(multi_model), 
         xlab = "Theoretical Quantiles",
         main = title)
  qqline(residuals(multi_model))
}
```

```{r}
sm_arb_män1 <- lm(sjmo ~ arblös_män, data = data_1)
sm_arb_tot1 <- lm(sjmo ~ arblös_tot, data = data_1)
sm_alk1 <- lm(sjmo ~ alko, data = data_1)
sm_urb1 <- lm(sjmo ~ urban, data = data_1)
sm_ski1 <- lm(sjmo ~ skilsmässo, data = data_1)
sm_rel1 <- lm(sjmo ~ religio, data = data_1)

sm_arb_män2 <- lm(sjmo ~ arblös_män, data = data_2)
sm_arb_tot2 <- lm(sjmo ~ arblös_tot, data = data_2)
sm_alk2 <- lm(sjmo ~ alko, data = data_2)
sm_urb2 <- lm(sjmo ~ urban, data = data_2)
sm_ski2 <- lm(sjmo ~ skilsmässo, data = data_2)
sm_rel2 <- lm(sjmo ~ religio, data = data_2)
```

```{r, echo=FALSE}
summary(sm_arb_män2)
summary(sm_arb_tot2)
summary(sm_alk1)
summary(sm_ski1)
```

```{r}
kable(cbind(c("Förklarande variabel", 
              "arbetslöshetsindex_män",
              "arbetslöshetsindex_total",
              "alkoholindex",
              "skilsmässoindex"),
            c("P-värde",
              "0.014",
              "0.0022",
              "0.00013",
              "0.0024")))
```

# 2.3 residuals model_1c

```{r}
par(mfrow = c(2,3))
plot_predicted_residuals(model_1c, "Residuals best model period 1")
plot_qq(model_1c, "Normal-QQ plot residuals")

plot.new()

plot(residuals(model_1c) ~ data_1$arblös_tot, 
     xlab = "arbetslöshetsindex total",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0) 
plot(residuals(model_1c) ~ data_1$alko, 
     xlab = "alkoholindex",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0) 
plot(residuals(model_1c) ~ data_1$religio, 
     xlab = "religiositetsindex",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0)

mtext("Residuals best model period 1", side = 3, line = - 1, outer = TRUE)
```

# 3.5 residuals model_1c

```{r}
par(mfrow = c(2,3))
plot_predicted_residuals(model_1c, "Residuals best model period 2")
plot_qq(model_1c, "Best Model Period 2: Normal-QQ plot residuals")

plot(residuals(model_1c) ~ data_2$arblös_tot, 
     xlab = "arbetslöshetsindex total",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0) 
plot(residuals(model_1c) ~ data_2$urban, 
     xlab = "urbaniseringsindex",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0) 
plot(residuals(model_1c) ~ data_2$skilsmässo, 
     xlab = "skilsmässoindex",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0) 
plot(residuals(model_1c) ~ data_2$religio, 
     xlab = "religiositetsindex",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0)

mtext("Residuals best model period 2", side = 3, line = - 1, outer = TRUE)
```

# residuals model_2c

```{r}
par(mfrow = c(2,3))
plot_predicted_residuals(model_2c, "Residuals alt model period 2")
plot_qq(model_2c, "Alt Model Period 2: Normal-QQ plot residuals")

plot.new()

plot(residuals(model_2c) ~ data_2$alko, 
     xlab = "alkoholindex",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0) 
plot(residuals(model_2c) ~ data_2$urban, 
     xlab = "urbaniseringsindex",
     ylab = "residuals",
     main = "Spread of residuals")
abline(0,0) 

mtext("Residuals alt model period 2", side = 3, line = - 1, outer = TRUE)
```
